- type: Exchange
  request: |
    !OciManifest
    image: ghcr.io/nginx/nginx-unprivileged:1.29.0-alpine-perl
  response:
    type: Success
    payload: '{"schemaVersion":2,"mediaType":"application/vnd.oci.image.index.v1+json","manifests":[{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:0b7d8e416ad2581a9bee68fe6f77aa38d0fa23af7e6e6f04a781c27369786182","size":2811,"platform":{"architecture":"amd64","os":"linux"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:fe954b85f942cfc9885d36db5867fe5aecc60d93bdba964fa7d5ccfbaffa4513","size":2811,"platform":{"architecture":"arm","os":"linux","variant":"v6"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:d22d5703e3d2a994764ec99737dc6e49da1ec9816ec409fab7c32a8dc6e78561","size":2811,"platform":{"architecture":"arm","os":"linux","variant":"v7"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:3a92f8ffe139e414e7b092ad29256c3cffdbb836a7dd24733287a441dac8d229","size":2811,"platform":{"architecture":"arm64","os":"linux"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:eab5d67705afd4b0a4a492843c819bee5e0f60b9ea387f5e240ac28b6916e150","size":2811,"platform":{"architecture":"386","os":"linux"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:f9db11b65e63f2546a72efe6ab603c734fec6d5d92ed48e5690fc3d85215b477","size":2812,"platform":{"architecture":"ppc64le","os":"linux"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:f558e7b67fcc50b06b96aa7153496c5a4d3f6722c8acf7dd669f96cf62a1c9e2","size":2811,"platform":{"architecture":"riscv64","os":"linux"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:20d6655e96f5c9e2b7a835e5ce34ea71535bc1920e706ea564961f767b06b411","size":2812,"platform":{"architecture":"s390x","os":"linux"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:c5b113cf7bbbb4d7a7cd222fdedd67fe3252b7c10f2420f3f1e0143dd14b6674","size":567,"platform":{"architecture":"unknown","os":"unknown"},"annotations":{"vnd.docker.reference.digest":"sha256:0b7d8e416ad2581a9bee68fe6f77aa38d0fa23af7e6e6f04a781c27369786182","vnd.docker.reference.type":"attestation-manifest"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:d24bc18931cfa7f506e37c73345a97dccea4a3601342e76992eaa0b319b4f077","size":567,"platform":{"architecture":"unknown","os":"unknown"},"annotations":{"vnd.docker.reference.digest":"sha256:fe954b85f942cfc9885d36db5867fe5aecc60d93bdba964fa7d5ccfbaffa4513","vnd.docker.reference.type":"attestation-manifest"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:895d2c18d349bd3fdc3f20fceb8aa09ca37a8f9e839b4a119c1fc666b3fb480b","size":567,"platform":{"architecture":"unknown","os":"unknown"},"annotations":{"vnd.docker.reference.digest":"sha256:d22d5703e3d2a994764ec99737dc6e49da1ec9816ec409fab7c32a8dc6e78561","vnd.docker.reference.type":"attestation-manifest"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:20f68dfb55474b36593a15ed4a5fc076c1d5e9c2fd44a950768f22c0ea0ac6cd","size":567,"platform":{"architecture":"unknown","os":"unknown"},"annotations":{"vnd.docker.reference.digest":"sha256:3a92f8ffe139e414e7b092ad29256c3cffdbb836a7dd24733287a441dac8d229","vnd.docker.reference.type":"attestation-manifest"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:55db21247900e5b769a755590ea9a4e399249a25e081b68ad8a3b71b5aae69ef","size":567,"platform":{"architecture":"unknown","os":"unknown"},"annotations":{"vnd.docker.reference.digest":"sha256:eab5d67705afd4b0a4a492843c819bee5e0f60b9ea387f5e240ac28b6916e150","vnd.docker.reference.type":"attestation-manifest"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:3a2f09e46a53c3f0cf787fa680e937ff6744dc62be68fc3177e09c80ec0d0382","size":567,"platform":{"architecture":"unknown","os":"unknown"},"annotations":{"vnd.docker.reference.digest":"sha256:f9db11b65e63f2546a72efe6ab603c734fec6d5d92ed48e5690fc3d85215b477","vnd.docker.reference.type":"attestation-manifest"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:5dd6e90244bc21ab1bfdaeacc05754c05a14c1044f0d7077613e53c4aee6c9f5","size":567,"platform":{"architecture":"unknown","os":"unknown"},"annotations":{"vnd.docker.reference.digest":"sha256:f558e7b67fcc50b06b96aa7153496c5a4d3f6722c8acf7dd669f96cf62a1c9e2","vnd.docker.reference.type":"attestation-manifest"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:2d8b3c5d0223af9cf1891dcbbc1d17d6e227b2795b4e726171250032977edafd","size":567,"platform":{"architecture":"unknown","os":"unknown"},"annotations":{"vnd.docker.reference.digest":"sha256:20d6655e96f5c9e2b7a835e5ce34ea71535bc1920e706ea564961f767b06b411","vnd.docker.reference.type":"attestation-manifest"}}],"annotations":{"org.opencontainers.image.created":"2025-08-18T04:01:50.306Z","org.opencontainers.image.description":"Unprivileged NGINX Dockerfiles","org.opencontainers.image.licenses":"Apache-2.0","org.opencontainers.image.revision":"a773d561b235f57f1c2417dbdef42348631ab0e6","org.opencontainers.image.source":"https://github.com/nginx/docker-nginx-unprivileged","org.opencontainers.image.title":"docker-nginx-unprivileged","org.opencontainers.image.url":"https://github.com/nginx/docker-nginx-unprivileged","org.opencontainers.image.version":"1.29.0-alpine-perl"}}'
- type: Exchange
  request: |
    !KubernetesListResourceNamespace
    api_version: storage.sbomscanner.kubewarden.io/v1alpha1
    kind: VulnerabilityReport
    namespace: sbomscanner
    label_selector: null
    field_selector: imageMetadata.digest=sha256:0b7d8e416ad2581a9bee68fe6f77aa38d0fa23af7e6e6f04a781c27369786182
    field_masks:
    - report.results.vulnerabilities.cve
    - report.results.vulnerabilities.fixedVersions
    - report.results.vulnerabilities.severity
    - report.results.vulnerabilities.suppressed
  response:
    type: Success
    payload: '{"apiVersion":"storage.sbomscanner.kubewarden.io/v1alpha1","kind":"VulnerabilityReportList","metadata":{},"items":[{"apiVersion":"storage.sbomscanner.kubewarden.io/v1alpha1","kind":"VulnerabilityReport","metadata":{"annotations":{},"creationTimestamp":"2026-02-20T08:39:44Z","labels":{"app.kubernetes.io/managed-by":"sbomscanner","app.kubernetes.io/part-of":"sbomscanner","sbomscanner.kubewarden.io/scanjob-uid":"f058a1d6-7034-491e-9600-41dc000cd20b"},"managedFields":[],"name":"644587e6105536def52d3218cd29759787e3b38e62646396ab2870ac1cb5d234","namespace":"sbomscanner","ownerReferences":[{"apiVersion":"storage.sbomscanner.kubewarden.io/v1alpha1","blockOwnerDeletion":true,"controller":true,"kind":"SBOM","name":"644587e6105536def52d3218cd29759787e3b38e62646396ab2870ac1cb5d234","uid":"6599d5d3-96f9-401b-bb3d-2a63966af2cf"}],"resourceVersion":"1","uid":"e99b1e0b-3b2b-41cf-9182-3dbd62759532"},"report":{"results":[{"vulnerabilities":[{"cve":"CVE-2024-58251","fixedVersions":["1.37.0-r20"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-46394","fixedVersions":["1.37.0-r20"],"severity":"LOW","suppressed":false},{"cve":"CVE-2024-58251","fixedVersions":["1.37.0-r20"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-46394","fixedVersions":["1.37.0-r20"],"severity":"LOW","suppressed":false},{"cve":"CVE-2025-62408","fixedVersions":["1.34.6-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-10148","fixedVersions":["8.14.1-r2"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-9086","fixedVersions":["8.14.1-r2"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-15467","fixedVersions":["3.5.5-r0"],"severity":"CRITICAL","suppressed":false},{"cve":"CVE-2025-69419","fixedVersions":["3.5.5-r0"],"severity":"HIGH","suppressed":false},{"cve":"CVE-2025-69421","fixedVersions":["3.5.5-r0"],"severity":"HIGH","suppressed":false},{"cve":"CVE-2025-11187","fixedVersions":["3.5.5-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-15468","fixedVersions":["3.5.5-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-15469","fixedVersions":["3.5.5-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-66199","fixedVersions":["3.5.5-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-68160","fixedVersions":["3.5.5-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-69418","fixedVersions":["3.5.5-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-69420","fixedVersions":["3.5.5-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-9230","fixedVersions":["3.5.4-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-9231","fixedVersions":["3.5.4-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2026-22795","fixedVersions":["3.5.5-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2026-22796","fixedVersions":["3.5.5-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-9232","fixedVersions":["3.5.4-r0"],"severity":"LOW","suppressed":false},{"cve":"CVE-2025-10148","fixedVersions":["8.14.1-r2"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-9086","fixedVersions":["8.14.1-r2"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-59375","fixedVersions":["2.7.2-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2026-25210","fixedVersions":["2.7.4-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2026-24515","fixedVersions":["2.7.4-r0"],"severity":"LOW","suppressed":false},{"cve":"CVE-2025-64720","fixedVersions":["1.6.51-r0"],"severity":"HIGH","suppressed":false},{"cve":"CVE-2025-65018","fixedVersions":["1.6.51-r0"],"severity":"HIGH","suppressed":false},{"cve":"CVE-2025-66293","fixedVersions":["1.6.53-r0"],"severity":"HIGH","suppressed":false},{"cve":"CVE-2026-22695","fixedVersions":["1.6.54-r0"],"severity":"HIGH","suppressed":false},{"cve":"CVE-2026-22801","fixedVersions":["1.6.54-r0"],"severity":"HIGH","suppressed":false},{"cve":"CVE-2025-64505","fixedVersions":["1.6.51-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-64506","fixedVersions":["1.6.51-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-15467","fixedVersions":["3.5.5-r0"],"severity":"CRITICAL","suppressed":false},{"cve":"CVE-2025-69419","fixedVersions":["3.5.5-r0"],"severity":"HIGH","suppressed":false},{"cve":"CVE-2025-69421","fixedVersions":["3.5.5-r0"],"severity":"HIGH","suppressed":false},{"cve":"CVE-2025-11187","fixedVersions":["3.5.5-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-15468","fixedVersions":["3.5.5-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-15469","fixedVersions":["3.5.5-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-66199","fixedVersions":["3.5.5-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-68160","fixedVersions":["3.5.5-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-69418","fixedVersions":["3.5.5-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-69420","fixedVersions":["3.5.5-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-9230","fixedVersions":["3.5.4-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-9231","fixedVersions":["3.5.4-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2026-22795","fixedVersions":["3.5.5-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2026-22796","fixedVersions":["3.5.5-r0"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-9232","fixedVersions":["3.5.4-r0"],"severity":"LOW","suppressed":false},{"cve":"CVE-2025-49794","fixedVersions":["2.13.9-r0"],"severity":"CRITICAL","suppressed":false},{"cve":"CVE-2025-49796","fixedVersions":["2.13.9-r0"],"severity":"CRITICAL","suppressed":false},{"cve":"CVE-2025-49795","fixedVersions":["2.13.9-r0"],"severity":"HIGH","suppressed":false},{"cve":"CVE-2025-6021","fixedVersions":["2.13.9-r0"],"severity":"HIGH","suppressed":false},{"cve":"CVE-2025-6170","fixedVersions":["2.13.9-r0"],"severity":"LOW","suppressed":false},{"cve":"CVE-2025-58050","fixedVersions":["10.46-r0"],"severity":"CRITICAL","suppressed":false},{"cve":"CVE-2024-58251","fixedVersions":["1.37.0-r20"],"severity":"MEDIUM","suppressed":false},{"cve":"CVE-2025-46394","fixedVersions":["1.37.0-r20"],"severity":"LOW","suppressed":false},{"cve":"CVE-2025-8961","fixedVersions":["4.7.1-r0"],"severity":"LOW","suppressed":false},{"cve":"CVE-2025-9165","fixedVersions":["4.7.1-r0"],"severity":"LOW","suppressed":false}]}]}}]}'
